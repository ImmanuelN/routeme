# RouteMe Project - Copilot Rules & Guidelines

## Project Overview
**RouteMe** is a cross-platform mobile navigation app built with React Native and Expo. It provides real-time location tracking, route calculation, and turn-by-turn navigation using Google Maps APIs.

## Technology Stack
- **Framework**: React Native with Expo SDK 54
- **Runtime**: Expo Go (no native modules allowed)
- **State Management**: React Context API
- **Maps**: react-native-maps (Expo managed)
- **Location**: expo-location
- **APIs**: Google Maps SDK, Directions API, Places API
- **Styling**: React Native StyleSheet
- **Safe Areas**: react-native-safe-area-context

## Architecture Patterns

### File Structure
```
src/
â”œâ”€â”€ components/     # Reusable UI components
â”œâ”€â”€ screens/        # Screen-level components
â”œâ”€â”€ context/        # Global state management
â”œâ”€â”€ hooks/          # Custom React hooks
â”œâ”€â”€ utils/          # Helper functions
â””â”€â”€ config/         # Configuration files
```

### Component Guidelines
1. **Functional Components**: Always use function components with hooks
2. **Props Documentation**: Include JSDoc comments for all props
3. **Memoization**: Use `useMemo` and `useCallback` for performance optimization
4. **Safe Area**: Always respect safe area insets for iOS/Android notches

### State Management Rules
1. **Location State**: Managed in `LocationContext.js`
   - `currentLocation`: User's GPS position
   - `destination`: Selected destination
   - `routeInfo`: Route data (distance, duration, steps)
   - `routeCoordinates`: Polyline coordinates
   - `isLoadingRoute`: Route calculation state
   - `isJourneyActive`: Navigation active state

2. **Context Updates**: Always log state changes for debugging
3. **Prevent Loops**: Use `useRef` to prevent infinite re-renders

### API Integration
1. **Google Maps APIs**: All API calls via `fetch` (no native modules)
2. **API Key**: Stored in `.env` via `react-native-dotenv`
3. **Error Handling**: Always catch and log API errors
4. **Rate Limiting**: Implement debouncing for search/autocomplete

### Performance Optimization
1. **Avoid Infinite Loops**: 
   - Use `useRef` for tracking fetch state
   - Memoize objects passed as props
   - Check dependencies in `useEffect`

2. **Minimize Re-renders**:
   - Use `React.memo` for expensive components
   - Destructure only needed context values
   - Avoid inline object/function creation in renders

### Styling Guidelines
1. **Modern UI Design**:
   - Floating elements with shadows
   - Rounded corners (borderRadius: 12-20)
   - Clean color palette (blues, grays, white)
   - Smooth animations (spring/timing)

2. **Safe Areas**:
   - Use `useSafeAreaInsets()` from react-native-safe-area-context
   - Apply insets to top/bottom positioned elements
   - Never hardcode status bar heights

3. **Responsive Design**:
   - Use `Dimensions.get('window')` for dynamic sizing
   - Test on various screen sizes
   - Support both portrait and landscape

### Navigation Features
1. **Route Calculation**:
   - Triggered when destination is selected
   - Shows loading state immediately
   - Displays distance, duration, turn-by-turn steps

2. **Active Journey**:
   - Started via "Start Journey" button
   - Minimizes modal to compact view
   - Hides search bar
   - Shows real-time navigation guidance

3. **Journey States**:
   - `inactive`: No route selected
   - `route_calculated`: Route shown, journey not started
   - `active`: Journey in progress

### Data Persistence
1. **Search History**: Cache recent searches in AsyncStorage
2. **Saved Places**: Store frequently visited locations
3. **Custom Names**: Allow users to name unknown locations

### Logging Standards
```javascript
// Use emoji prefixes for log categories
console.log('ğŸ¯ [Context] ...') // State updates
console.log('ğŸš€ [Component] ...') // Component actions
console.log('ğŸ—ºï¸ [Maps] ...') // Map operations
console.log('ğŸ“ [Location] ...') // Location tracking
console.log('âœ… [Success] ...') // Successful operations
console.log('âŒ [Error] ...') // Errors
console.log('âš ï¸ [Warning] ...') // Warnings
```

### Code Quality
1. **Naming Conventions**:
   - Components: PascalCase (e.g., `LocationDetailsModal`)
   - Functions: camelCase (e.g., `handleStartJourney`)
   - Constants: UPPER_SNAKE_CASE (e.g., `GOOGLE_MAPS_API_KEY`)
   - Files: PascalCase for components, camelCase for utils

2. **Comments**:
   - JSDoc for all exported functions/components
   - Inline comments for complex logic
   - TODO comments for future improvements

3. **Error Handling**:
   - Try-catch for async operations
   - User-friendly error messages
   - Fallback UI for error states

### Testing Considerations
1. **Expo Go Compatible**: All features must work in Expo Go
2. **No Native Modules**: Avoid libraries requiring custom native code
3. **Graceful Degradation**: Handle missing permissions/connectivity

### Git Workflow
1. **Commits**: Clear, descriptive messages
2. **Branches**: Feature branches for major changes
3. **Code Review**: Self-review before committing

## Feature Implementation Checklist

When implementing new features:
- [ ] Check Expo Go compatibility
- [ ] Add proper TypeScript/JSDoc types
- [ ] Implement error handling
- [ ] Add loading states
- [ ] Respect safe areas
- [ ] Add appropriate logging
- [ ] Test on both iOS and Android (if possible)
- [ ] Optimize for performance
- [ ] Update this rules file if needed

## Common Pitfalls to Avoid
1. âŒ Don't use native modules (breaks Expo Go)
2. âŒ Don't create inline objects in render (causes re-renders)
3. âŒ Don't forget dependency arrays in useEffect
4. âŒ Don't hardcode dimensions (use responsive sizing)
5. âŒ Don't ignore safe area insets
6. âŒ Don't make API calls without error handling
7. âŒ Don't update state in render functions
8. âŒ Don't forget to clean up intervals/timeouts

## Resources
- [Expo Documentation](https://docs.expo.dev/)
- [React Native Maps](https://github.com/react-native-maps/react-native-maps)
- [Google Maps Platform](https://developers.google.com/maps)
- [React Navigation](https://reactnavigation.org/) (if needed)

## Current Project State (Updated: 2025-10-24)

### Completed Features
âœ… Real-time location tracking
âœ… Google Places autocomplete search
âœ… Route calculation via Directions API
âœ… Polyline route display on map
âœ… Bottom modal with route details
âœ… Safe area support
âœ… Performance optimization (no infinite loops)

### In Progress
ğŸ”¨ Active journey mode with minimized modal
ğŸ”¨ Search history caching
ğŸ”¨ Custom location naming
ğŸ”¨ Modern UI redesign with floating elements

### Planned Features
ğŸ“‹ Turn-by-turn voice navigation
ğŸ“‹ Real-time rerouting on deviation
ğŸ“‹ Traffic layer integration
ğŸ“‹ Favorite locations
ğŸ“‹ Journey history

---

**Last Updated**: October 24, 2025
**Maintainer**: RouteMe Development Team
